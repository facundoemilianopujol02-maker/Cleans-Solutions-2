<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clean Solutions | Cat√°logo</title>
    <style>
        /* RESET Y BASE */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: #f4f7f9; display: flex; flex-direction: column; min-height: 100vh; color: #333; }

        /* NAVBAR MODERNA */
        .navbar { background: white; min-height: 100px; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 15px rgba(0,0,0,0.1); display: flex; align-items: center; }
        .nav-container { max-width: 1400px; margin: 0 auto; width: 100%; display: flex; justify-content: space-between; align-items: center; padding: 10px 20px; gap: 20px; }

        .brand { display: flex; align-items: center; gap: 15px; }
        .logo-img { height: 70px; width: auto; border-radius: 10px; }
        .brand-name { font-size: 1.5rem; font-weight: 900; color: #0052cc; letter-spacing: -1px; }

        .search-container { flex: 1; max-width: 500px; position: relative; }
        #inputBusqueda { width: 100%; padding: 12px 45px 12px 20px; border-radius: 50px; border: 2px solid #eee; background: #f9f9f9; outline: none; font-size: 1rem; transition: 0.3s; }
        #inputBusqueda:focus { border-color: #0052cc; background: white; box-shadow: 0 4px 12px rgba(0,82,204,0.1); }
        .search-icon { position: absolute; right: 20px; top: 13px; color: #aaa; }

        /* GRID DE PRODUCTOS */
        .content-wrapper { flex: 1; width: 100%; max-width: 1300px; margin: 30px auto; padding: 0 20px; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 25px; }
        
        .item-card { background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.05); transition: 0.3s; cursor: pointer; position: relative; border: 1px solid #f0f0f0; }
        .item-card:hover { transform: translateY(-8px); box-shadow: 0 12px 25px rgba(0,0,0,0.1); }
        .item-img { height: 240px; background: #f8f8f8; }
        .item-img img { width: 100%; height: 100%; object-fit: cover; }

        .item-info { padding: 20px; text-align: center; }
        .item-info h4 { font-size: 1.1rem; margin-bottom: 8px; color: #2d3436; }
        .item-price { font-size: 1.6rem; color: #00b894; font-weight: 800; }

        /* ADMIN ELEMENTS */
        .nav-actions { display: flex; gap: 10px; }
        .btn-primary { background: #0052cc; color: white; border: none; padding: 10px 20px; border-radius: 50px; font-weight: bold; cursor: pointer; }
        .admin-group { display: none; gap: 8px; }
        .btn-admin { padding: 8px 15px; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; color: white; }
        
        /* FOOTER */
        .main-footer { background: #2d3436; color: white; padding: 40px 20px; text-align: center; margin-top: 50px; }
        .main-footer a { color: #00a8ff; text-decoration: none; }

        /* MODALES */
        .modal-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.6); backdrop-filter: blur(4px); display:none; justify-content:center; align-items:center; z-index:2000; padding: 15px; }
        .modal-card { background: white; border-radius: 25px; max-width: 450px; width: 100%; padding: 30px; position: relative; box-shadow: 0 20px 40px rgba(0,0,0,0.2); }
        .detail-card { max-width: 850px; padding: 0; overflow: hidden; }
        
        .detail-flex { display: flex; flex-wrap: wrap; }
        .detail-img { width: 50%; height: 450px; }
        .detail-img img { width: 100%; height: 100%; object-fit: cover; }
        .detail-txt { width: 50%; padding: 40px; display: flex; flex-direction: column; justify-content: center; }

        .close-btn { position: absolute; top: 15px; right: 20px; font-size: 30px; cursor: pointer; color: #666; z-index: 10; }

        @media (max-width: 768px) {
            .nav-container { flex-direction: column; }
            .detail-flex { flex-direction: column; }
            .detail-img, .detail-txt { width: 100%; height: auto; }
            .detail-img { height: 250px; }
        }
    </style>
</head>
<body>

    <header class="navbar">
        <div class="nav-container">
            <div class="brand">
                <img src="logo.png" alt="Logo" class="logo-img">
                <span class="brand-name">CLEAN SOLUTIONS</span>
            </div>
            
            <div class="search-container">
                <input type="text" id="inputBusqueda" placeholder="¬øQu√© est√°s buscando?" onkeyup="filtrarProductos()">
                <span class="search-icon">üîç</span>
            </div>
            
            <div class="nav-actions">
                <button id="btnEntrarAdmin" class="btn-primary" onclick="abrirModal('modalDeLogin')">üîë Panel</button>
                <div id="panelAdminGlobal" class="admin-group">
                    <button onclick="prepararFormulario('add')" class="btn-admin" style="background:#2ecc71">‚ûï</button>
                    <button onclick="salirAdmin()" class="btn-admin" style="background:#e74c3c">üö™</button>
                </div>
            </div>
        </div>
    </header>

    <main class="content-wrapper">
        <div id="contenedorProductos" class="product-grid">
            <div style="grid-column: 1/-1; text-align: center; padding: 50px;">
                <h2 id="status-msg">Cargando cat√°logo profesional...</h2>
            </div>
        </div>
    </main>

    <footer class="main-footer">
        <p>üì± WhatsApp: <a href="https://wa.me/543794034489">3794034489</a> | üì∏ Instagram: @clean.solutions610</p>
        <p style="margin-top:15px; font-size:0.8rem; opacity:0.6;">&copy; 2026 Clean Solutions Argentina</p>
    </footer>

    <div id="modalVerProducto" class="modal-overlay">
        <div class="modal-card detail-card">
            <span class="close-btn" onclick="cerrarModal('modalVerProducto')">&times;</span>
            <div class="detail-flex">
                <div class="detail-img"><img id="det-img" src="" alt=""></div>
                <div class="detail-txt">
                    <h2 id="det-nombre"></h2>
                    <p id="det-precio" style="font-size: 2.5rem; color: #00b894; font-weight: 800; margin: 10px 0;"></p>
                    <p id="det-desc" style="color: #636e72; line-height: 1.6; margin-bottom: 25px;"></p>
                    <a id="det-link" href="#" target="_blank" style="background:#25d366; color:white; text-decoration:none; padding:15px; border-radius:12px; text-align:center; font-weight:bold;">Pedir por WhatsApp</a>
                </div>
            </div>
        </div>
    </div>

    <div id="modalDeLogin" class="modal-overlay">
        <div class="modal-card">
            <h3 style="text-align:center; margin-bottom:20px;">Acceso Restringido</h3>
            <input type="password" id="inputClave" placeholder="Contrase√±a de administrador" style="width:100%; padding:15px; border-radius:10px; border:1px solid #ddd; margin-bottom:15px;">
            <button onclick="validarAcceso()" class="btn-primary" style="width:100%">Entrar al Sistema</button>
            <button onclick="cerrarModal('modalDeLogin')" style="width:100%; background:none; border:none; margin-top:10px; color:#aaa; cursor:pointer;">Cancelar</button>
        </div>
    </div>

    <script>
        // CONFIGURACI√ìN
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby1pr5Jl3tuC_J8L8yLv8Xybj66DJRneZFx7qL3fYi7r7TPIwjLBMtzuVVuNJyZYKNZ/exec';
        let BASE_DATOS = [];

        // 1. DEFINIR LA FUNCI√ìN DE RECEPCI√ìN GLOBALMENTE
        window.procesarGet = function(data) {
            console.log("Datos recibidos correctamente!");
            BASE_DATOS = data.productos || [];
            dibujarCards(BASE_DATOS);
        };

        // 2. PEDIR DATOS AL CARGAR
        window.onload = () => {
            const isAdmin = localStorage.getItem('clean_admin') === 'true';
            if(isAdmin) {
                document.getElementById('btnEntrarAdmin').style.display = 'none';
                document.getElementById('panelAdminGlobal').style.display = 'flex';
            }
            
            // Llamada JSONP
            const script = document.createElement('script');
            script.src = `${SCRIPT_URL}?action=get&callback=procesarGet`;
            document.body.appendChild(script);
        };

        // 3. DIBUJAR PRODUCTOS
        function dibujarCards(lista) {
            const contenedor = document.getElementById('contenedorProductos');
            if(lista.length === 0) {
                contenedor.innerHTML = '<div style="grid-column:1/-1; text-align:center">No se encontraron productos.</div>';
                return;
            }

            contenedor.innerHTML = '';
            lista.forEach(p => {
                const card = document.createElement('div');
                card.className = 'item-card';
                card.onclick = () => abrirDetalle(p);
                card.innerHTML = `
                    <div class="item-img"><img src="${p.imagen || 'https://via.placeholder.com/400'}" alt=""></div>
                    <div class="item-info">
                        <h4>${p.nombre}</h4>
                        <p class="item-price">$${p.precio}</p>
                    </div>
                `;
                contenedor.appendChild(card);
            });
        }

        // 4. FILTRAR (BUSCADOR)
        function filtrarProductos() {
            const query = document.getElementById('inputBusqueda').value.toLowerCase();
            const filtrados = BASE_DATOS.filter(p => 
                p.nombre.toLowerCase().includes(query) || 
                (p.descripcion && p.descripcion.toLowerCase().includes(query))
            );
            dibujarCards(filtrados);
        }

        // 5. MODALES Y NAVEGACI√ìN
        function abrirModal(id) { document.getElementById(id).style.display = 'flex'; }
        function cerrarModal(id) { document.getElementById(id).style.display = 'none'; }

        function abrirDetalle(p) {
            document.getElementById('det-img').src = p.imagen || 'https://via.placeholder.com/400';
            document.getElementById('det-nombre').innerText = p.nombre;
            document.getElementById('det-precio').innerText = `$${p.precio}`;
            document.getElementById('det-desc').innerText = p.descripcion || 'Sin descripci√≥n disponible.';
            document.getElementById('det-link').href = `https://wa.me/543794034489?text=Hola! Me interesa el producto: ${p.nombre}`;
            abrirModal('modalVerProducto');
        }

        function validarAcceso() {
            const clave = document.getElementById('inputClave').value;
            if(clave === 'Ragnar2025') {
                localStorage.setItem('clean_admin', 'true');
                location.reload();
            } else { alert("Clave incorrecta"); }
        }

        function salirAdmin() {
            localStorage.removeItem('clean_admin');
            location.reload();
        }
    </script>
</body>
</html>
